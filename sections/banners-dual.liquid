{% comment %}
  Dual Responsive Banners Section
{% endcomment %}

{%- style -%}
  .myBannerContainer-{{ section.id }} {
    display: flex;
    gap: {{ section.settings.gap }}px;
    flex-wrap: wrap;
    margin-top: {{ section.settings.margin_top }}px;
    margin-bottom: {{ section.settings.margin_bottom }}px;
    width: 100%;
  }
  
  .myBannerItem-{{ section.id }} {
    flex: 1 1 calc(50% - {{ section.settings.gap }}px);
    text-align: center;
    text-decoration: none;
    overflow: hidden;
    display: block;
  }

  .myBannerImage-{{ section.id }} {
    width: 100%;
    height: auto;
    vertical-align: middle;
    object-fit: cover;
    aspect-ratio: 2220 / 1200;
    display: block;
  }

  @media (max-width: 768px) {
    .myBannerContainer-{{ section.id }} {
      flex-direction: column;
    }
    .myBannerItem-{{ section.id }} {
      flex: 1 1 100%;
      width: 100%;
    }
  }
{%- endstyle -%}

<div class="myBannerContainer-{{ section.id }} page-width">
  {%- for block in section.blocks -%}
    {%- liquid 
       # Create class name as a variable to avoid syntax errors
       assign img_class = 'myBannerImage-' | append: section.id 
       
       # Determine loading priority
       assign loading_type = 'lazy'
       if section.index == 1
         assign loading_type = 'eager'
       endif
    -%}

    <a class="myBannerItem-{{ section.id }}" href="{{ block.settings.link }}" {{ block.shopify_attributes }}>
      {%- if block.settings.image != blank -%}
        <img 
          src="{{ block.settings.image | image_url: width: 1500 }}"
          srcset="{{ block.settings.image | image_url: width: 750 }} 750w, {{ block.settings.image | image_url: width: 1500 }} 1500w, {{ block.settings.image | image_url: width: 2220 }} 2220w"
          sizes="(max-width: 768px) 100vw, 50vw"
          alt="{{ block.settings.image.alt | escape }}"
          class="{{ img_class }}"
          loading="{{ loading_type }}"
          width="{{ block.settings.image.width }}"
          height="{{ block.settings.image.height }}"
        >
      {%- else -%}
        {%- # This ensures something is visible in the editor even if no image is picked -%}
        <div style="background: #f3f3f3; aspect-ratio: 2220/1200; display: flex; align-items: center; justify-content: center; border: 1px dashed #ccc;">
          {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg' }}
        </div>
      {%- endif -%}
    </a>
  {%- endfor -%}
</div>

{% schema %}
{
  "name": "Dual Banners",
  "max_blocks": 2,
  "settings": [
    {
      "type": "range",
      "id": "gap",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Gap between banners",
      "default": 3
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Margin Top",
      "default": 0
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Margin Bottom",
      "default": 0
    }
  ],
  "blocks": [
    {
      "type": "banner",
      "name": "Banner",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Banner Image"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Banner Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Dual Banners",
      "blocks": [
        { "type": "banner" },
        { "type": "banner" }
      ]
    }
  ]
}
{% endschema %}