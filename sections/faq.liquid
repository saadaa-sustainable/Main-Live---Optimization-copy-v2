{% comment %}
FAQ rendering priorities:
1) Product metafield: product.metafields.custom.faq2 (metaobject with faq_q_1..faq_q_7 & faq_a_1..faq_a_7)
2) Selected Collection metafield: selected_collection.metafields.custom.faq2
3) Manual section blocks
{% endcomment %}

{%- comment -%}
Select collection (keep your existing list; used only as a fallback)
{%- endcomment -%}
{% assign selected_collection = blank %}



{% for collection in product.collections %}
 {% if collection.title contains 'Women Airy Linen Short Kurtas' 
or collection.title contains 'Women Airy Linen Long Kurtas' 
or collection.title contains 'Women Airy Linen Shirts'
or collection.title contains 'Women Everyday Cotton Top'
or collection.title contains 'Women 4-Way Scretchable Pants'
or collection.title contains 'Women Everyday Cotton Pants'
or collection.title contains 'Women Formal Pants'
or collection.title contains 'Women Airy Linen Shorts'
or collection.title contains 'Women V-Neck Sleeveless Tops'
or collection.title contains 'Women Wide Leg Pants'
or collection.title contains 'Women Airy Linen Pants'
or collection.title contains 'Women Viscose Pleated Tops'
or collection.title contains 'Women Airy Linen Straight Pants'
or collection.title contains 'Women Viscose Palazzo Pants'   
or collection.title contains 'Women Airy Linen Wide Leg Pants'
or collection.title contains 'Women Airy Linen Flared Dress'
or collection.title contains 'Women Straight Fit Formal Pants'
or collection.title contains 'Women Pure Linen Notch Collar Shirts'
or collection.title contains 'Women Pure Linen Shirts'
or collection.title contains 'Women Cotton Camisole Top'
or collection.title contains 'Women Airy Linen Mid Thigh Length Kurta'
or collection.title contains 'Women Airy Linen Split Neck Short Kurta'
or collection.title contains 'Women Cotton Straight Pants'
or collection.title contains 'Women Cotton Regular Pants'
or collection.title contains 'Women Linen Blend Knot Blouse'
or collection.title contains 'Women Linen Blend Pleated Tops'
or collection.title contains 'Women Linen Blend Wide Leg Pants'
or collection.title contains 'Women Linen Blend Waist Coat'


or collection.title contains 'Men Formal Shirts'
or collection.title contains 'Men Airy Linen Short Kurtas'
or collection.title contains 'MEN AIRY-LINEN SHORT KURTAS'
or collection.title contains 'Men Airy Linen Long Kurtas'
or collection.title contains 'Men 100% Linen Full Sleeve Shirts'
or collection.title contains 'Men 100% Linen Half Sleeve Shirts'
or collection.title contains 'Men Cotton Pants'
or collection.title contains 'Men Pure Linen Short Sleeve Shirts'
or collection.title contains 'Men Pure Linen Full Sleeve Shirts'
or collection.title contains 'Men Linen Blend Short Sleeve Shirts'
or collection.title contains 'Men Linen Blend Mandarin Collar Shirts'
or collection.title contains 'Men Flat Knit Collared T-shirt'
or collection.title contains 'Men Flat Knit Round Neck T-shirt'
or collection.title contains 'Men Linen Blend Straight Pants'

 

or collection.title contains 'TOTE BAGS'
or collection.title contains 'AIRY-LINEN LONG KURTAS VWO'
or collection.title contains 'Co-ords'
or collection.title contains 'bundles'
or collection.title contains 'Build Your Own Bundle'
or collection.title contains 'PALAZZO PANTS'
or collection.title contains 'Airy Linen Wide Leg Pant'
or collection.title contains 'V-Neck Sleeveless Top'




or collection.title contains 'Women Plus Size Cotton Pant'
or collection.title contains 'Women Plus Size Wide Leg Pant'
or collection.title contains 'Women Plus Size Formal Pant'
or collection.title contains 'Women Plus Size Sleeveless Top'
or collection.title contains 'Women Plus Size Pleated Top'
or collection.title contains 'Women Plus Size Viscose Palazzo Pant'
or collection.title contains 'Women Plus Size Airy-Linen Shirt'
or collection.title contains 'Women Plus Size Airy Linen Short Kurta'
or collection.title contains 'Women Plus Size Straight Fit Formal Pants'
or collection.title contains 'Men Plus Size Formal Shirts'


or collection.title contains 'Unisex Zip Neck Sweatshirts'
or collection.title contains 'Unisex Round Neck Sweatshirts'
or collection.title contains 'Unisex Pullover Fleece Hoodies'
 
    
 %}
    {% assign selected_collection = collection %}
    {% break %}
  {% endif %}
{% endfor %}

{%- comment -%}
Decide the FAQ source:
- product_faq_meta: product metafield object (metaobject)
- collection_faq_meta: collection metafield object (metaobject)
- faq_mode: 'product' | 'collection' | 'blocks'
{%- endcomment -%}
{% assign product_faq_meta = blank %}
{% if product.metafields.custom.faq2 and product.metafields.custom.faq2.value %}
  {% assign product_faq_meta = product.metafields.custom.faq2.value %}
{% endif %}

{% assign collection_faq_meta = blank %}
{% if selected_collection and selected_collection.metafields.custom.faq2 and selected_collection.metafields.custom.faq2.value %}
  {% assign collection_faq_meta = selected_collection.metafields.custom.faq2.value %}
{% endif %}

{% assign faq_mode = 'blocks' %}
{% if product_faq_meta != blank %}
  {% assign faq_mode = 'product' %}
{% elsif collection_faq_meta != blank %}
  {% assign faq_mode = 'collection' %}
{% endif %}

{%- if section.blocks.size > 0 -%}
  <div
    class="section-spacing space {% if section.settings.separate_section_with_border %}bordered-section{% endif %} navigate"
    id="faq"
  >
    <div class="container container--{{ section.settings.content_width }}">
      <div class="section-stack">
        {%- render 'section-header',
          subheading: section.settings.subheading,
          heading: section.settings.title,
          content: section.settings.content
        -%}

        {% if faq_mode == 'blocks' %}
          <div class="faq">
            {%- assign categories_blocks = section.blocks | where: 'type', 'category' -%}

            {%- if section.settings.show_categories and categories_blocks.size > 0 -%}
              <faq-toc class="faq__toc hidden md:grid">
                {%- for block in categories_blocks -%}
                  <a class="faq__toc-item {% if forloop.first %}is-active{% endif %}" href="#block-{{ block.id }}">
                    {{- block.settings.title -}}
                  </a>
                {%- endfor -%}
              </faq-toc>
            {%- endif -%}

            <div class="faq__content">
              {%- for block in section.blocks -%}
                {%- case block.type -%}
                  {%- when 'category' -%}
                    {%- if block.settings.title != blank -%}
                      <p id="block-{{ block.id }}" class="faq__category h4" {{ block.shopify_attributes }}>
                        {%- if block.settings.custom_icon != blank -%}
                          {%- capture sizes -%}{{ block.settings.icon_width }}px{%- endcapture -%}
                          {%- capture widths -%}{{ block.settings.icon_width }}, {{ block.settings.icon_width | times: 2 | at_most: block.settings.custom_icon.width }}{%- endcapture -%}
                          {%- capture style -%}--image-max-width: {{ block.settings.icon_width }}px{%- endcapture -%}
                          {{-
                            block.settings.custom_icon
                            | image_url: width: block.settings.custom_icon.width
                            | image_tag:
                              loading: 'lazy',
                              sizes: sizes,
                              widths: widths,
                              class: 'constrained-image',
                              style: style
                          -}}
                        {%- elsif block.settings.icon != 'none' -%}
                          {%- render 'icon' with block.settings.icon, width: block.settings.icon_width -%}
                        {%- endif -%}
                        {{- block.settings.title -}}
                      </p>
                    {%- endif -%}

                  {%- when 'question' -%}
                    {%- if block.settings.question != blank and block.settings.answer != blank -%}
                      {%- capture answer -%}
                        <div class="prose">
                          {{- block.settings.answer -}}
                        </div>
                      {%- endcapture -%}
                      {%- render 'accordion',
                        title: block.settings.question,
                        content: answer,
                        show_title_as_text: true,
                        block: block
                      -%}
                    {%- endif -%}
                {%- endcase -%}
              {%- endfor -%}
            </div>
          </div>

        {% else %}
          {%- assign current_meta = product_faq_meta -%}
          {% if faq_mode == 'collection' %}
            {%- assign current_meta = collection_faq_meta -%}
          {% endif %}

          <div class="faq">
            <div class="faq__content">
              {%- comment -%}
              Render up to 7 Q/A pairs: faq_q_1 ... faq_q_7 + faq_a_1 ... faq_a_7
              Increase the range if your metaobject has more fields.
              {%- endcomment -%}
              {% for i in (1..7) %}
                {% assign q_key = 'faq_q_' | append: i %}
                {% assign a_key = 'faq_a_' | append: i %}

                {% assign q = blank %}
                {% assign a = blank %}
                {% if current_meta[q_key] and current_meta[q_key].value != blank %}
                  {% assign q = current_meta[q_key].value %}
                {% endif %}
                {% if current_meta[a_key] and current_meta[a_key].value != blank %}
                  {% assign a = current_meta[a_key].value %}
                {% endif %}

                {% if q != blank and a != blank %}
                  {%- render 'accordion', title: q, content: a, show_title_as_text: true -%}
                {% endif %}
              {% endfor %}
            </div>
          </div>
        {% endif %}
      </div>
    </div>
  </div>

  {%- comment -%} JSON-LD: emit the same questions actually shown {%- endcomment -%}
  <script type="application/ld+json">
    {%- assign question_blocks = section.blocks | where: 'type', 'question' -%}
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {% if faq_mode == 'blocks' %}
          {%- for block in question_blocks -%}
            {
              "@type": "Question",
              "name": {{ block.settings.question | json }},
              "acceptedAnswer": {
                "@type": "Answer",
                "text": {{ block.settings.answer | json }}
              }
            }{% unless forloop.last %},{% endunless %}
          {%- endfor -%}
        {% else %}
          {%- assign current_meta = product_faq_meta -%}
          {% if faq_mode == 'collection' %}
            {%- assign current_meta = collection_faq_meta -%}
          {% endif %}
          {%- assign first = true -%}
          {%- for i in (1..7) -%}
            {%- assign q_key = 'faq_q_' | append: i -%}
            {%- assign a_key = 'faq_a_' | append: i -%}
            {%- assign q = blank -%}
            {%- assign a = blank -%}
            {%- if current_meta[q_key] and current_meta[q_key].value != blank -%}
              {%- assign q = current_meta[q_key].value -%}
            {%- endif -%}
            {%- if current_meta[a_key] and current_meta[a_key].value != blank -%}
              {%- assign a = current_meta[a_key].value -%}
            {%- endif -%}
            {%- if q != blank and a != blank -%}
              {%- unless first -%},{%- endunless -%}
              {
                "@type": "Question",
                "name": {{ q | json }},
                "acceptedAnswer": {
                  "@type": "Answer",
                  "text": {{ a | json }}
                }
              }
              {%- assign first = false -%}
            {%- endif -%}
          {%- endfor -%}
        {% endif %}
      ]
    }
  </script>
{%- endif -%}

{% schema %}
{
  "name": "t:sections.faq.name",
  "class": "shopify-section--faq",
  "tag": "section",
  "disabled_on": {
    "groups": ["header", "custom.overlay"]
  },
  "settings": [
    {
      "type": "checkbox",
      "id": "separate_section_with_border",
      "label": "t:global.section.separate_section_with_border",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_categories",
      "label": "t:sections.faq.show_categories"
    },
    {
      "type": "header",
      "content": "t:global.section.header_category"
    },
    {
      "type": "inline_richtext",
      "id": "subheading",
      "label": "t:global.text.subheading",
      "default": "Need help?"
    },
    {
      "type": "inline_richtext",
      "id": "title",
      "label": "t:global.text.heading",
      "default": "Frequently Asked Questions"
    },
    {
      "type": "richtext",
      "id": "content",
      "label": "t:global.text.content"
    },
    {
      "type": "select",
      "id": "content_width",
      "label": "t:global.sizes.content_width",
      "options": [
        { "value": "xs", "label": "t:global.sizes.x_small" },
        { "value": "sm", "label": "t:global.sizes.small" },
        { "value": "md", "label": "t:global.sizes.medium" },
        { "value": "lg", "label": "t:global.sizes.large" },
        { "value": "container", "label": "Container" }
      ],
      "default": "sm"
    }
  ],
  "blocks": [
    {
      "type": "category",
      "name": "t:sections.faq.blocks.category.name",
      "settings": [
        { "type": "inline_richtext", "id": "title", "label": "t:global.text.title", "default": "Category" },
        {
          "type": "select",
          "id": "icon",
          "label": "t:global.icons.icon",
          "options": [
            { "value": "none", "label": "t:global.icons.none" },
            { "value": "picto-award-gift", "label": "t:global.icons.award_gift", "group": "t:global.icons.shop_category" },
            { "value": "picto-bag-handle", "label": "t:global.icons.bag_handle", "group": "t:global.icons.shop_category" },
            { "value": "picto-building", "label": "t:global.icons.building", "group": "t:global.icons.shop_category" },
            { "value": "picto-coupon", "label": "t:global.icons.coupon", "group": "t:global.icons.shop_category" },
            { "value": "picto-gift", "label": "t:global.icons.gift", "group": "t:global.icons.shop_category" },
            { "value": "picto-info", "label": "t:global.icons.info", "group": "t:global.icons.shop_category" },
            { "value": "picto-love", "label": "t:global.icons.love", "group": "t:global.icons.shop_category" },
            { "value": "picto-percent", "label": "t:global.icons.percent", "group": "t:global.icons.shop_category" },
            { "value": "picto-star", "label": "t:global.icons.star", "group": "t:global.icons.shop_category" },
            { "value": "picto-box", "label": "t:global.icons.box", "group": "t:global.icons.shipping_category" },
            { "value": "picto-delivery-truck", "label": "t:global.icons.delivery_truck", "group": "t:global.icons.shipping_category" },
            { "value": "picto-pin", "label": "t:global.icons.pin", "group": "t:global.icons.shipping_category" },
            { "value": "picto-plane", "label": "t:global.icons.plane", "group": "t:global.icons.shipping_category" },
            { "value": "picto-return", "label": "t:global.icons.return", "group": "t:global.icons.shipping_category" },
            { "value": "picto-credit-card", "label": "t:global.icons.credit_card", "group": "t:global.icons.payment_and_security_category" },
            { "value": "picto-lock", "label": "t:global.icons.lock", "group": "t:global.icons.payment_and_security_category" },
            { "value": "picto-money", "label": "t:global.icons.money", "group": "t:global.icons.payment_and_security_category" },
            { "value": "picto-secure-profile", "label": "t:global.icons.secure_profile", "group": "t:global.icons.payment_and_security_category" },
            { "value": "picto-shield", "label": "t:global.icons.shield", "group": "t:global.icons.payment_and_security_category" },
            { "value": "picto-earth", "label": "t:global.icons.earth", "group": "t:global.icons.ecology_category" },
            { "value": "picto-leaf", "label": "t:global.icons.leaf", "group": "t:global.icons.ecology_category" },
            { "value": "picto-recycle", "label": "t:global.icons.recycle", "group": "t:global.icons.ecology_category" },
            { "value": "picto-tree", "label": "t:global.icons.tree", "group": "t:global.icons.ecology_category" },
            { "value": "picto-at-sign", "label": "t:global.icons.at_sign", "group": "t:global.icons.tech_category" },
            { "value": "picto-bluetooth", "label": "t:global.icons.bluetooth", "group": "t:global.icons.tech_category" },
            { "value": "picto-camera", "label": "t:global.icons.camera", "group": "t:global.icons.tech_category" },
            { "value": "picto-printer", "label": "t:global.icons.printer", "group": "t:global.icons.tech_category" },
            { "value": "picto-smart-watch", "label": "t:global.icons.smart_watch", "group": "t:global.icons.tech_category" },
            { "value": "picto-wifi", "label": "t:global.icons.wifi", "group": "t:global.icons.tech_category" },
            { "value": "picto-avatar", "label": "t:global.icons.avatar", "group": "t:global.icons.communication_category" },
            { "value": "picto-chat", "label": "t:global.icons.chat", "group": "t:global.icons.communication_category" },
            { "value": "picto-calendar", "label": "t:global.icons.calendar", "group": "t:global.icons.communication_category" },
            { "value": "picto-comment", "label": "t:global.icons.comment", "group": "t:global.icons.communication_category" },
            { "value": "picto-customer-support", "label": "t:global.icons.customer_support", "group": "t:global.icons.communication_category" },
            { "value": "picto-happy-face", "label": "t:global.icons.happy_face", "group": "t:global.icons.communication_category" },
            { "value": "picto-mailbox", "label": "t:global.icons.mailbox", "group": "t:global.icons.communication_category" },
            { "value": "picto-mobile-phone", "label": "t:global.icons.mobile_phone", "group": "t:global.icons.communication_category" },
            { "value": "picto-operator", "label": "t:global.icons.operator", "group": "t:global.icons.communication_category" },
            { "value": "picto-phone", "label": "t:global.icons.phone", "group": "t:global.icons.communication_category" },
            { "value": "picto-send", "label": "t:global.icons.send", "group": "t:global.icons.communication_category" },
            { "value": "picto-user", "label": "t:global.icons.user", "group": "t:global.icons.communication_category" },
            { "value": "picto-burger", "label": "t:global.icons.burger", "group": "t:global.icons.food_category" },
            { "value": "picto-beer", "label": "t:global.icons.beer", "group": "t:global.icons.food_category" },
            { "value": "picto-coffee", "label": "t:global.icons.coffee", "group": "t:global.icons.food_category" },
            { "value": "picto-pizza", "label": "t:global.icons.pizza", "group": "t:global.icons.food_category" },
            { "value": "picto-bottle", "label": "t:global.icons.bottle", "group": "t:global.icons.food_category" },
            { "value": "picto-document", "label": "t:global.icons.document", "group": "t:global.icons.other_category" },
            { "value": "picto-error", "label": "t:global.icons.error", "group": "t:global.icons.other_category" },
            { "value": "picto-file", "label": "t:global.icons.file", "group": "t:global.icons.other_category" },
            { "value": "picto-jewelry", "label": "t:global.icons.jewelry", "group": "t:global.icons.other_category" },
            { "value": "picto-mask", "label": "t:global.icons.mask", "group": "t:global.icons.other_category" },
            { "value": "picto-music", "label": "t:global.icons.music", "group": "t:global.icons.other_category" },
            { "value": "picto-not-allowed", "label": "t:global.icons.not_allowed", "group": "t:global.icons.other_category" },
            { "value": "picto-target", "label": "t:global.icons.target", "group": "t:global.icons.other_category" },
            { "value": "picto-timer", "label": "t:global.icons.timer", "group": "t:global.icons.other_category" },
            { "value": "picto-success", "label": "t:global.icons.success", "group": "t:global.icons.other_category" }
          ],
          "default": "none"
        },
        { "type": "image_picker", "id": "custom_icon", "label": "t:global.icons.custom_icon", "info": "t:global.icons.custom_icon_info" },
        { "type": "range", "id": "icon_width", "min": 12, "max": 32, "step": 4, "unit": "px", "label": "t:global.icons.icon_width", "default": 16 }
      ]
    },
    {
      "type": "question",
      "name": "t:sections.faq.blocks.question.name",
      "settings": [
        { "type": "inline_richtext", "id": "question", "label": "t:sections.faq.blocks.question.question", "default": "Question" },
        { "type": "richtext", "id": "answer", "label": "t:sections.faq.blocks.question.answer", "default": "<p>Write a clear and concise answer to guide your customers.</p>" }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.faq.presets.faq.name",
      "blocks": [
        { "type": "category", "settings": { "title": "Order" } },
        { "type": "question", "settings": { "question": "Do you ship overseas?", "answer": "<p>Yes, we ship all over the world. Shipping costs will apply, and will be added at checkout. We run discounts and promotions all year, so stay tuned for exclusive deals.</p>" } },
        { "type": "question", "settings": { "question": "How long will it take to get my orders?", "answer": "<p>It depends on where you are. Orders processed here will take 5-7 business days to arrive. Overseas deliveries can take anywhere from 7-16 days. Delivery details will be provided in your confirmation email.</p>" } },
        { "type": "question", "settings": { "question": "Any question?", "answer": "<p>You can contact us through our contact page! We will be happy to assist you.</p>" } }
      ]
    }
  ]
}
{% endschema %}
