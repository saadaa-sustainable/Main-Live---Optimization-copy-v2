{%- comment -%}
  ----------------------------------------------------------------------------------------------------------------------
  PRODUCT CARD COMPONENT
  ----------------------------------------------------------------------------------------------------------------------

  This component is used in collection and featured collection to render a single product as a card

  ********************************************
  Supported variables
  ********************************************

  * product: the product to render
  * stacked: define if the product is stacked or not on mobile
  * reveal: if set to true, the card will be revealed on scroll through animation
  * show_badges: show or not the badges (default to true if nothing is set).
  * show_rating: show or not the rating. If nothing is set, the theme uses the default product card setting
  * show_vendor: show or not the vendor. If nothing is set, the theme uses the default product card setting
  * show_quick_buy: show or not the quick buy (which open a modal if the product contains more than 1 choice)
  * show_secondary_image: show or not the secondary media on hover. If nothing is set, the theme uses the default product card setting
  * show_swatches: show or not the swatches. The swatch type is inferred from setting, and will default to true if nothing is set.
  * hide_product_information: if set to true, all content (vendor, badge, title...) are not rendered, to create image-based grid
  * quick_buy_context: a unique text to dissociate quick buy if the same product is embedded multiple times
{%- endcomment -%}

{%- liquid
  if hide_product_information
    assign show_badges = false
    assign show_rating = false
    assign show_vendor = false
    assign show_title = false
    assign show_prices = false
    assign show_swatches = false
    assign show_quick_buy = show_quick_buy | default: settings.show_quick_buy, allow_false: true
    assign show_secondary_image = show_secondary_image | default: settings.show_secondary_image, allow_false: true
  else
    assign show_badges = show_badges | default: true, allow_false: true
    assign show_rating = show_rating | default: settings.show_product_rating, allow_false: true
    assign show_vendor = show_vendor | default: settings.show_vendor, allow_false: true
    assign show_quick_buy = show_quick_buy | default: settings.show_quick_buy, allow_false: true
    assign show_title = true
    assign show_prices = true
    assign show_secondary_image = show_secondary_image | default: settings.show_secondary_image, allow_false: true
    assign show_swatches = show_swatches | default: true, allow_false: true
  endif

  # Hide rating on Pre Launch collection
  if collection and collection.title == 'Pre Launch'
    assign show_rating = false
  endif
-%}
{% liquid
  assign publishDateInSecond = product.published_at | date: '%s' | plus: 7776000
  assign dateNow = 'now' | date: '%s' | times: 1
%}

<product-card
  {% if reveal %}
    reveal-on-scroll="true"
  {% endif %}
  handle="{{ product.handle | escape }}"
  {% if product.url contains 'cotton-trouser' %}
    data-collection="Women Everyday Cotton Pants"
  {% endif %}
>
  <button
    class="PWC_card_product_wishlist pwc_card-product-wishlist-button"
    data-product-id="{{ product.handle }}"
  ><div class="wishlist-icon-svg"></div></button>

  {%- assign total_inventory = 0 -%}
  {%- for variant in product.variants -%}
    {%- assign total_inventory = total_inventory | plus: variant.inventory_quantity -%}
  {%- endfor -%}

  {%- comment -%}
    Wrapper: <div> for Pre Launch (no PDP link), otherwise <a> to PDP
  {%- endcomment -%}
  {% comment %} {% if collection and collection.title == "Pre Launch" %}
    <div class="product-card" data-inventory="{{ total_inventory }}">
  {% else %} {% endcomment %}
{%- if product.tags contains 'on_top_of_collection' -%}
  {%- assign pinned_attr = 'true' -%}
{%- else -%}
  {%- assign pinned_attr = 'false' -%}
{%- endif -%}

<a
  href="{{ product.url }}"
  class="product-card"
  data-inventory="{{ total_inventory }}"
  data-pinned="{{ pinned_attr }}"
>

  {% comment %} {% endif %} {% endcomment %}

    {%- comment -%}
      --------------------------------------------------------------------------------------------------------------------
      PRODUCT MEDIA
      --------------------------------------------------------------------------------------------------------------------
    {%- endcomment -%}
    {%- if product.media.size > 0 -%}
      <div class="product-card__figure">
        {%- if show_badges -%}
          {%- render 'product-badges', product: product, vertical: true -%}
        {%- endif -%}

        {% if product.tags contains 'new_launch' or product.tags contains 'new_color'%}
          <span class="nav-badge-new"><span>NEW LAUNCH</span></span>
          {% elsif product.tags contains 'pre_launch' %}
          <span class="nav-badge-new"style="background:#ffee03; color:black;letter-spacing:-.5px;"><span>PRE LAUNCH</span></span>
        {% elsif publishDateInSecond >= dateNow or product.tags contains 'Badges__New' %}
          <span class="nav-badge-new"><span>NEW</span></span>
        {% endif %}

        {% if product.tags contains 'community_exclusive' %}
          <span class="nav-badge-new1">COMMUNITY EXCLUSIVE</span>
        {% endif %}

        {% if product.tags contains 'Badges__BEST-SELLER' %}
          <span class="nav-badge-new" style="background:#ffee03; color:black;letter-spacing:-.5px;">
            <span>BEST-SELLER</span>
          </span>
        {% endif %}

        {% comment %} {% if product.tags contains '40_lea' %}
  <span class="nav-badge-new lea-40" style="font-size: 11px;  top:20px;">40 Lea</span>
{% endif %} {% endcomment %}
{% comment %} {% if product.tags contains '44_lea' %}
  <span class="nav-badge-new lea-44" style="font-size: 11px; top:20px;">44 Lea</span>
{% endif %}

{% if product.tags contains '44_lea_coarser' %}
  <span class="nav-badge-new lea-44" style="background:#ffee03; color:black;letter-spacing:-.5px;font-size: 11px;">Coarser Fabric</span>
{% endif %} {% endcomment %}

{% if product.tags contains '40_lea_softer' %}
  <span class="nav-badge-new lea-44" style="background:#ffee03; color:black;letter-spacing:-.5px;font-size: 11px;">European Linen</span>
{% endif %}




        <div class="product-card__media" data-instant>
          {%- capture sizes -%}
            {%- if stacked -%}
              (max-width: 699px) calc(100vw / {{ section.settings.products_per_row_mobile }}), (max-width: 999px) calc(100vw / {{ 3 | at_most: section.settings.products_per_row_desktop | default: 3 }} - 64px), calc((100vw - 96px) / {{ section.settings.products_per_row_desktop | default: 3 }} - (24px / {{ section.settings.products_per_row_desktop | default: 3 }} * {{ section.settings.products_per_row_desktop | default: 3 | minus: 1 }}))
            {%- else -%}
              (max-width: 699px) 74vw, (max-width: 999px) 38vw, calc((100vw - 96px) / {{ section.settings.products_per_row_desktop | default: 3 }} - (24px / {{ section.settings.products_per_row_desktop | default: 3 }} * {{ section.settings.products_per_row_desktop | default: 3 | minus: 1 }}))
            {%- endif -%}
          {%- endcapture -%}

          {%- capture main_image_classes -%}
            product-card__image product-card__image--primary {% if settings.product_image_aspect_ratio contains 'crop' %}object-cover{% endif %} aspect-{{ settings.product_image_aspect_ratio | split: '_' | first }}
          {%- endcapture -%}

          {{-
            product.featured_media
            | image_url: width: 300
            | image_tag:
              loading: 'lazy',
              sizes: sizes,
              widths: '200,300,400,500,600,700,800,1000,1200,1400,1600,1800',
              class: main_image_classes
          -}}

          {%- if show_secondary_image and product.media.size > 1 -%}
            {%- assign next_media = product.media[2] | default: product.media[2] -%}
            {{-
              next_media
              | image_url: width: next_media.width
              | image_tag:
                class: 'product-card__image product-card__image--secondary',
                loading: 'lazy',
                fetchpriority: 'low',
                sizes: sizes,
                widths: '200,300,400,500,600,700,800,1000,1200,1400,1600,1800'
            -}}
          {%- endif -%}
        </div>

        {% if page.handle == 'loyalty-customer' %}
          {%- if show_quick_buy and product.available -%}
            {%- if product.variants.size == 1 and product.selling_plan_groups.size == 0 -%}
              {%- form 'product', product, is: 'product-form' -%}
                <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
                <button type="submit" class="product-card__quick-add-button">
                  <span class="sr-only">{{ 'product.general.add_to_cart_button' | t }}</span>
                  {%- render 'icon' with 'plus' -%}
                </button>
              {%- endform -%}
            {%- else -%}
              {%- capture quick_buy_id -%}product-quick-buy-{{ section.id }}-{{ block.id }}-{{ quick_buy_context }}-{{ product.id }}{%- endcapture -%}
              <button type="button" aria-controls="{{ quick_buy_id }}" class="product-card__quick-add-button">
                <span class="sr-only">{{ 'product.general.choose_options' | t }}</span>
                {%- render 'icon' with 'plus' -%}
              </button>
              <quick-buy-modal handle="{{ product.handle }}" class="quick-buy-modal modal" id="{{ quick_buy_id }}"></quick-buy-modal>
            {%- endif -%}
          {%- endif -%}
        {% endif %}
      </div>
    {%- endif -%}

    {%- comment -%}
      --------------------------------------------------------------------------------------------------------------------
      PRODUCT INFO
      --------------------------------------------------------------------------------------------------------------------
    {%- endcomment -%}
    <div class="product-card__info empty:hidden">
      {%- assign text_class = '' -%}
      {%- if settings.product_card_text_font == 'heading' -%}
        {%- assign text_class = 'h6' -%}
      {%- endif -%}

      {%- if show_title or show_prices or show_vendor and product.vendor != blank -%}
        <div class="v-stack justify-items-center gap-2">
          {%- if show_vendor and product.vendor != blank -%}
            {%- capture vendor_class -%}smallcaps {% if settings.product_card_text_font == 'heading' %}heading hidden {% endif %}{% endcapture %}
            {%- render 'vendor' with product.vendor, class: vendor_class -%}
          {%- endif -%}

          {%- if show_title or show_prices -%}
            <div class="v-stack justify-items-center gap-1">
              {%- if show_title -%}
                <div
                  class="product-title {% if text_class != blank %}{{ text_class }}{% endif %} {% if settings.product_title_max_lines > 0 %}line-clamp{% endif %}"
                  {% if settings.product_title_max_lines > 0 %}
                    style="--line-clamp-count: {{ settings.product_title_max_lines }}"
                  {% endif %}
                  data-instant
                >
                  {{- product.title -}}
                </div>
              {%- endif -%}

              {%- if show_prices -%}
                {%- assign first_variant = product.selected_or_first_available_variant -%}




{% comment %} New Price Optiphoenic code start {% endcomment %}





{% comment %} <div class="price-list">



  {% comment %} <span class="price">
    {{ first_variant.price | money }}
  </span>

  {%- if first_variant.compare_at_price > first_variant.price -%}
    <!-- Use real compare at price -->
    <span class="compare-at-price">
      {{ first_variant.compare_at_price | money }}
    </span>
  {%- else -%}
    <!-- Fake compare at price (2x base price) -->
    <span class="compare-at-price">
      {{ first_variant.price | times: 2 | money }}
    </span>
  {%- endif -%}  {% endcomment %}

                {% assign product_mappings = "
                  AIRY LINEN FLARED DRESS|359900|179900;
                  AIRY LINEN PANT|239900|119900;
                  AIRY LINEN SHIRT|239900|119900;
                  Airy Linen Straight Pant|239900|119900;
                  Airy Linen Straight Pants|239900|119900;
                  AIRY LINEN WIDE LEG PANT|259800|129900;
                  Women Everyday Cotton Pants|159900|79900;
                  EVERYDAY COTTON TOP|199900|99900;
                  AIRY LINEN LONG KURTA|199900|99900;
                  AIRY LINEN PANT|169900|89900;
                  AIRY LINEN SHORTS|139900|59900;
                  AIRY LINEN SHORT KURTA|159900|79900;
                  MENS SHORT KURTA|99900|99900;
                  PALAZZO|159900|79900;
                  VISCOSE PLEATED TOP|259900|129900;
                  RAYON SLEEVELESS TOP|159900|79900;
                  FORMAL PANT|399900|149900;
                  STRAIGHT FIT FORMAL PANTS|299900|159900;
                  4-WAY STRETCHABLE PANT|299900|149900;
                  TOTE BAG|99900|59900;
                  NOTCH COLLAR SHIRT|439800|219900;
                  PURE LINEN SHIRT|499800|249900;
                  PURE LINEN SHORT SLEEVE|439800|219900; 
                  PURE LINEN FULL SLEEVE|499800|249900;
                  VISCOSE PALAZZO|159900|79900;
                  WIDE LEG PANTS|399900|199900;
                  MENS COTTON PANT|199900|99900;
                  MENS AIRY LINEN LONG KURTA|259900|129900;
                  MENS AIRY LINEN SHORT KURTA|199900|99900;
                  MENS HALF SLEEVE 100% LINEN SHIRT|439900|219900;
                  MENS LINEN PANTS|0|0; 
                  MENS 100% LINEN SHIRT|499900|249900;
                  MENS SATIN FORMAL SHIRT|299900|149900
                " | split: ";" %}

                {% assign matched_mrp = 0 %}
                {% assign matched_selling_price = 0 %}

                {% comment %} Loop through mappings to find a match {% endcomment %}
                {% for mapping in product_mappings %}
                  {% assign parts = mapping | strip | split: "|" %}
                  {% if parts.size == 3 %}
                    {% assign map_name = parts[0] | strip %}
                    {% assign map_mrp = parts[1] | strip | times: 1 %}
                    {% assign map_selling = parts[2] | strip | times: 1 %}
                    
                    {% comment %} Normalize to uppercase for case-insensitive comparison {% endcomment %}
                    {% assign normalized_title = product.title | upcase %}
                    {% assign normalized_map_name = map_name | upcase %}
                    
                    {% if normalized_title contains normalized_map_name and product.price == map_selling %}
                      {% assign matched_mrp = map_mrp %}
                      {% assign matched_selling_price = map_selling %}
                      {% break %}  
                    {% endif %}
                  {% endif %}
                {% endfor %}


                {% comment %} Display prices and save percentage if matched {% endcomment %}
               <div class="product-prices">
              {% if matched_mrp > 0 and matched_mrp > matched_selling_price %}
                {% assign save_amount = matched_mrp | minus: matched_selling_price %}
                {% assign save_percentage = save_amount | times: 100 | divided_by: matched_mrp | round %}
                
                <span class="selling-price">{{ matched_selling_price | money_without_trailing_zeros }}</span>
                <span class="compare-at-price-wrap">MRP <span class="compare-at-price">{{ matched_mrp | money_without_trailing_zeros }}</span></span>
                {% comment %} <span class="save-percentage">{{ save_percentage }}% OFF</span> {% endcomment %}
              {% else %}
                {% assign variant = product.selected_or_first_available_variant %}
                <sale-price {% if form_id %}form="{{ product_form_id }}"{% endif %} class=" h4 {% if variant.compare_at_price > variant.price %}{{ on_sale_price_classes }}{% else %}{{ regular_price_classes }}{% endif %}">
                  <span class="sr-only">{{ 'product.price.sale_price' | t }}</span>
                  {%- if settings.currency_code_enabled -%}
                    {{- product.selected_or_first_available_variant.price | money_without_trailing_zeros -}}
                  {%- else -%}
                    {{- product.selected_or_first_available_variant.price | money_without_trailing_zeros -}}
                  {%- endif -%}
                </sale-price>
                {% if variant.compare_at_price and variant.compare_at_price > variant.price %}
                  <compare-at-price class="{{ compare_at_price_classes }}" id="compare-at-price">
                    MRP
                    <span class="sr-only">{{ 'product.price.regular_price' | t }}</span>
                    <span class="c-price">{{ variant.compare_at_price | money_without_trailing_zeros }}</span>
                  </compare-at-price>
                {% endif %}
              {% endif %}
            </div>


</div>  {% endcomment %}

 {% comment %} New Price Optiphoenix code end {% endcomment %}



{% comment %} NEW CODE BY SAADAA DEV {% endcomment %}


{% comment %} <div class="price-list">



  {% comment %} <span class="price">
    {{ first_variant.price | money }}
  </span>

  {%- if first_variant.compare_at_price > first_variant.price -%}
    <!-- Use real compare at price -->
    <span class="compare-at-price">
      {{ first_variant.compare_at_price | money }}
    </span>
  {%- else -%}
    <!-- Fake compare at price (2x base price) -->
    <span class="compare-at-price">
      {{ first_variant.price | times: 2 | money }}
    </span>
  {%- endif -%}  {% endcomment %}

                {%- assign product_mappings = "
WOMEN|AIRY LINEN FLARED DRESS|359900|179900;
WOMEN|AIRY LINEN PANT|239900|119900;
WOMEN|AIRY-LINEN SHIRT|239900|119900;
WOMEN|AIRY LINEN STRAIGHT PANT|239900|119900;
WOMEN|AIRY LINEN WIDE LEG PANT|259800|129900;
WOMEN|COTTON PANT|159900|79900;
WOMEN|COTTON TOP|199900|99900;
WOMEN|AIRY LINEN LONG KURTA|199900|99900;
WOMEN|AIRY LINEN PANT|169900|89900;
WOMEN|AIRY-LINEN SHORTS|139900|59900;
WOMEN|AIRY LINEN SHORT KURTA|159900|79900;
WOMEN|PALAZZO|159900|79900;
WOMEN|VISCOSE PLEATED TOP|259900|129900;
WOMEN|V-NECK SLEEVELESS TOP|159900|79900;
WOMEN|FORMAL PANT|399900|149900;
WOMEN|STRAIGHT FIT FORMAL PANTS|299900|159900;
WOMEN|4-WAY STRETCHABLE PANT|299900|149900;
UNISEX|TOTE BAG|99900|49900;
WOMEN|VISCOSE PALAZZO|159900|79900;
WOMEN|WIDE LEG PANTS|399900|199900;
MEN|COTTON PANT|179800|89900;
MEN|AIRY LINEN LONG KURTA|259900|129900;
MEN|AIRY LINEN SHORT KURTA|199900|99900;
MEN|LINEN HALF SLEEVE SHIRT|439900|219900;
MEN|100% LINEN SHIRT|499900|249900;
MEN|FORMAL SHIRT|299900|149900;
MEN|PURE LINEN FULL SLEEVE|499800|249900;
MEN|PURE LINEN SHORT SLEEVE|439800|219900;
WOMEN|PURE LINEN SHIRT|499800|249900;
WOMEN|PURE LINEN NOTCH COLLAR SHIRT|439800|219900;
WOMEN|COTTON REGULAR PANT|159900|79900;
WOMEN|COTTON STRAIGHT PANT|159900|79900;
WOMEN|SPLIT NECK SHORT KURTA|139800|69900;
WOMEN|AIRY LINEN MID THIGH LENGTH KURTA|179800|89900;
WOMEN|COTTON CAMISOLE TOP|99800|49900;
" | split: ";" -%}

                {% assign matched_mrp = 0 %}
                {% assign matched_selling_price = 0 %}

                {%- comment -%} Detect gender from product title (MEN / WOMEN). Blank = unknown (backward compatible). {%- endcomment -%}
                {% assign normalized_title = product.title | upcase %}
                {% assign title_padded = ' ' | append: normalized_title | append: ' ' %}
                {% assign detected_category = '' %}
                {% if title_padded contains ' MEN ' or title_padded contains ' MENS ' or title_padded contains " MEN'S " %}
                  {% assign detected_category = 'MEN' %}
                {% elsif title_padded contains ' WOMEN ' or title_padded contains " WOMEN'S " or title_padded contains ' WOMENS ' %}
                  {% assign detected_category = 'WOMEN' %}
                {% endif %}

                {% comment %} Loop through mappings: prefer 4-part (CATEGORY|NAME|MRP|SELL); still supports legacy 3-part rows {% endcomment %}
                {% for mapping in product_mappings %}
                  {% assign parts = mapping | strip | split: "|" %}
                  {% if parts.size == 4 %}
                    {% assign map_cat  = parts[0] | strip | upcase %}
                    {% assign map_name = parts[1] | strip %}
                    {% assign map_mrp  = parts[2] | strip | times: 1 %}
                    {% assign map_sell = parts[3] | strip | times: 1 %}
                    {% assign normalized_map_name = map_name | upcase %}

                    {% assign cat_ok = true %}
                    {% if detected_category != '' and map_cat != 'UNISEX' and map_cat != detected_category %}
                      {% assign cat_ok = false %}
                    {% endif %}

                    {% if cat_ok and normalized_title contains normalized_map_name and product.price == map_sell and map_sell > 0 %}
                      {% assign matched_mrp = map_mrp %}
                      {% assign matched_selling_price = map_sell %}
                      {% break %}
                    {% endif %}

                  {% elsif parts.size == 3 %}
                    {%- comment -%} Legacy fallback (no category) {%- endcomment -%}
                    {% assign map_name = parts[0] | strip %}
                    {% assign map_mrp  = parts[1] | strip | times: 1 %}
                    {% assign map_sell = parts[2] | strip | times: 1 %}
                    {% assign normalized_map_name = map_name | upcase %}
                    {% if normalized_title contains normalized_map_name and product.price == map_sell and map_sell > 0 %}
                      {% assign matched_mrp = map_mrp %}
                      {% assign matched_selling_price = map_sell %}
                      {% break %}
                    {% endif %}
                  {% endif %}
                {% endfor %}


                {% comment %} Display prices and save percentage if matched {% endcomment %}
               <div class="product-prices">
              {% if matched_mrp > 0 and matched_mrp > matched_selling_price %}
                {% assign save_amount = matched_mrp | minus: matched_selling_price %}
                {% assign save_percentage = save_amount | times: 100 | divided_by: matched_mrp | round %}
                
                <span class="selling-price">{{ matched_selling_price | money_without_trailing_zeros }}</span>
                <span class="compare-at-price-wrap">MRP <span class="compare-at-price">{{ matched_mrp | money_without_trailing_zeros }}</span></span>
                {% comment %} <span class="save-percentage">{{ save_percentage }}% OFF</span> {% endcomment %}
              {% else %}
                {% assign variant = product.selected_or_first_available_variant %}
                <sale-price {% if form_id %}form="{{ product_form_id }}"{% endif %} class=" h4 {% if variant.compare_at_price > variant.price %}{{ on_sale_price_classes }}{% else %}{{ regular_price_classes }}{% endif %}">
                  <span class="sr-only">{{ 'product.price.sale_price' | t }}</span>
                  {%- if settings.currency_code_enabled -%}
                    {{- product.selected_or_first_available_variant.price | money_without_trailing_zeros -}}
                  {%- else -%}
                    {{- product.selected_or_first_available_variant.price | money_without_trailing_zeros -}}
                  {%- endif -%}
                </sale-price>
                {% if variant.compare_at_price and variant.compare_at_price > variant.price %}
                  <compare-at-price class="{{ compare_at_price_classes }}" id="compare-at-price">
                    MRP
                    <span class="sr-only">{{ 'product.price.regular_price' | t }}</span>
                    <span class="c-price">{{ variant.compare_at_price | money_without_trailing_zeros }}</span>
                  </compare-at-price>
                {% endif %}
              {% endif %}
            </div>


</div>  {% endcomment %}



{% comment %} NEW CODE BY SAADAA DEV {% endcomment %}


  



{% comment %} NEW CODE FOR PRE LAUNCH AFTERWARDS UNCOMMENT THE ABOVE CODE START {% endcomment %}




<div class="price-list">
  {%- comment -%}
    =============================
    PRICE LOGIC WITH CATEGORIES
    =============================
    • Tries to match product against product_mappings:
        CATEGORY|NAME|MRP|SELL
      - CATEGORY: MEN / WOMEN / UNISEX
      - NAME is matched case-insensitively against product.title
      - SELL is matched against the selected variant's price
    • If a 3-part mapping (NAME|MRP|SELL) is found, it still works.
    • If no mapping matches, we fall back to tag overrides (SMLFS / SDLNS / SDLS / SMLSS),
      else we show the real variant price/compare_at_price.
  {%- endcomment -%}

  {%- assign product_mappings = "
WOMEN|AIRY LINEN FLARED DRESS|359900|179900;
WOMEN|AIRY LINEN PANT|239900|119900;
WOMEN|AIRY-LINEN SHIRT|239900|119900;
WOMEN|AIRY LINEN STRAIGHT PANT|239900|119900;
WOMEN|AIRY LINEN WIDE LEG PANT|199800|99900;
WOMEN|COTTON PANT|159900|79900;
WOMEN|COTTON TOP|0|0;
WOMEN|AIRY LINEN LONG KURTA|199900|99900;
WOMEN|AIRY LINEN PANT|169900|89900;
WOMEN|AIRY-LINEN SHORTS|139900|59900;
WOMEN|AIRY LINEN SHORT KURTA|159900|79900;
WOMEN|PALAZZO|159900|79900;
WOMEN|VISCOSE PLEATED TOP|259900|129900;
WOMEN|V-NECK SLEEVELESS TOP|159900|79900;
WOMEN|FORMAL PANT|299800|149900;
WOMEN|STRAIGHT FIT FORMAL PANTS|299900|159900;
WOMEN|4-WAY STRETCHABLE PANT|299800|149900;
WOMEN|PURE LINEN SHIRT|499800|249900;
WOMEN|PURE LINEN NOTCH COLLAR SHIRT|439800|219900;
WOMEN|COTTON REGULAR PANT|159900|79900;
WOMEN|COTTON STRAIGHT PANT|159800|79900;
WOMEN|SPLIT NECK SHORT KURTA|139800|69900;
WOMEN|AIRY LINEN MID THIGH LENGTH KURTA|199800|99900;
WOMEN|COTTON CAMISOLE TOP|99800|49900;
WOMEN|VISCOSE PALAZZO|159900|79900;
WOMEN|WIDE LEG PANTS|399900|199900;


MEN|COTTON PANT|179800|89900;
MEN|AIRY LINEN LONG KURTA|259800|129900;
MEN|AIRY LINEN SHORT KURTA|199900|99900;
MEN|LINEN HALF SLEEVE SHIRT|439900|219900;
MEN|100% LINEN SHIRT|499900|249900;
MEN|PURE LINEN FULL SLEEVE|499800|249900;
MEN|PURE LINEN SHORT SLEEVE|439800|219900;
MEN|FORMAL SHIRT|279800|139900;


UNISEX|TOTE BAG|99900|49900;
UNISEX|PULLOVER FLEECE HOODIE|299800|149900;
UNISEX|ROUND NECK SWEATSHIRT|199800|99900;
UNISEX|ZIP NECK SWEATSHIRT|299800|149900;
" | split: ";" -%}

  {%- comment -%} Core refs {%- endcomment -%}
  {%- assign variant = product.selected_or_first_available_variant -%}
  {%- assign price_to_check = variant.price -%}

  {%- comment -%} Normalize title and a padded version for robust matching {%- endcomment -%}
  {%- assign normalized_title = product.title | upcase -%}
  {%- assign title_padded = ' ' | append: normalized_title | append: ' ' -%}

  {%- comment -%}
    Detect category from multiple fields:
    - Look in title first; if not found, also check vendor/type/tags/handle (downcased).
  {%- endcomment -%}
  {%- assign haystack = '' -%}
  {%- assign haystack = haystack
    | append: product.title | append: ','
    | append: product.vendor | append: ','
    | append: product.type | append: ','
    | append: product.handle | append: ','
    | append: product.tags | join: ',' | upcase -%}

  {%- assign detected_category = '' -%}
  {%- if title_padded contains ' MEN ' or title_padded contains ' MENS ' or title_padded contains " MEN'S " or haystack contains ' MEN ' or haystack contains ' MENS ' or haystack contains " MEN'S " -%}
    {%- assign detected_category = 'MEN' -%}
  {%- elsif title_padded contains ' WOMEN ' or title_padded contains ' WOMENS ' or title_padded contains " WOMEN'S " or haystack contains ' WOMEN ' or haystack contains ' WOMENS ' or haystack contains " WOMEN'S " -%}
    {%- assign detected_category = 'WOMEN' -%}
  {%- endif -%}

  {%- comment -%} Attempt mapping match (4-part preferred; 3-part legacy supported) {%- endcomment -%}
  {%- assign matched_mrp = 0 -%}
  {%- assign matched_selling_price = 0 -%}

  {%- for mapping in product_mappings -%}
    {%- assign parts = mapping | strip | split: "|" -%}
    {%- if parts.size == 0 or parts == blank -%}{% continue %}{%- endif -%}

    {%- if parts.size == 4 -%}
      {%- assign map_cat  = parts[0] | strip | upcase -%}
      {%- assign map_name = parts[1] | strip -%}
      {%- assign map_mrp  = parts[2] | strip | times: 1 -%}
      {%- assign map_sell = parts[3] | strip | times: 1 -%}

      {%- assign normalized_map_name = map_name | upcase -%}

      {%- assign cat_ok = true -%}
      {%- if detected_category != '' and map_cat != 'UNISEX' and map_cat != detected_category -%}
        {%- assign cat_ok = false -%}
      {%- endif -%}

      {%- if cat_ok and normalized_title contains normalized_map_name and price_to_check == map_sell and map_sell > 0 -%}
        {%- assign matched_mrp = map_mrp -%}
        {%- assign matched_selling_price = map_sell -%}
        {%- break -%}
      {%- endif -%}

    {%- elsif parts.size == 3 -%}
      {%- comment -%} Legacy without category {%- endcomment -%}
      {%- assign map_name = parts[0] | strip -%}
      {%- assign map_mrp  = parts[1] | strip | times: 1 -%}
      {%- assign map_sell = parts[2] | strip | times: 1 -%}
      {%- assign normalized_map_name = map_name | upcase -%}

      {%- if normalized_title contains normalized_map_name and price_to_check == map_sell and map_sell > 0 -%}
        {%- assign matched_mrp = map_mrp -%}
        {%- assign matched_selling_price = map_sell -%}
        {%- break -%}
      {%- endif -%}
    {%- endif -%}
  {%- endfor -%}

  {%- comment -%}
    Tag-based overrides (only when no mapping matched).
    You can extend this list as needed.
  {%- endcomment -%}
  {%- assign override_active = false -%}
  {%- assign override_price_cents = 0 -%}
  {%- assign override_compare_cents = 0 -%}
  {% comment %} {%- if matched_selling_price == 0 -%}
    {%- if product.tags contains 'SMLFS' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 199900 -%}
      {%- assign override_compare_cents = 249900 -%}
    {%- elsif product.tags contains 'SDLNS' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 169900 -%}
      {%- assign override_compare_cents = 219900 -%}
    {%- elsif product.tags contains 'SDLS' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 199900 -%}
      {%- assign override_compare_cents = 249900 -%}
    {%- elsif product.tags contains 'SMLSS' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 169900 -%}
      {%- assign override_compare_cents = 219900 -%}
    {%- endif -%}
  {%- endif -%} {% endcomment %}


{% comment %} 
    {%- if matched_selling_price == 0 -%}
    {%- if product.tags contains 'SURNS' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 89900 -%}
      {%- assign override_compare_cents = 99900 -%}

       {%- elsif product.tags contains 'SUZNS' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 129900 -%}
      {%- assign override_compare_cents = 149900 -%}

       {%- elsif product.tags contains 'SUPFH' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 129900 -%}
      {%- assign override_compare_cents = 149900 -%}


      {%- elsif product.tags contains 'SMFS' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 139900 -%}
      {%- assign override_compare_cents = 279800 -%}

        {% comment %} {%- elsif product.tags contains 'SDECT' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 69900 -%}
      {%- assign override_compare_cents = 99900 -%} {% endcomment %}
    {%- endif -%}
  {%- endif -%} {% endcomment %}





    {%- if matched_selling_price == 0 -%}
    {%- if product.tags contains 'SDSLP' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 99900 -%}
      {%- assign override_compare_cents = 149900 -%}


    {%- elsif product.tags contains 'SMFLK' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 99900 -%}
      {%- assign override_compare_cents = 129900 -%}

        {% comment %} {%- elsif product.tags contains 'SDECT' -%}
      {%- assign override_active = true -%}
      {%- assign override_price_cents = 69900 -%}
      {%- assign override_compare_cents = 99900 -%} {% endcomment %}
    {%- endif -%}
  {%- endif -%}

  {%- comment -%} ============ RENDERING ============ {%- endcomment -%}
  <div class="product-prices">
    {%- if matched_mrp > 0 and matched_mrp > matched_selling_price -%}
      {%- assign save_amount = matched_mrp | minus: matched_selling_price -%}
      {%- assign save_percentage = save_amount | times: 100 | divided_by: matched_mrp | round -%}

      <span class="selling-price">
        {{ matched_selling_price | money_without_trailing_zeros }}
      </span>
      <span class="compare-at-price-wrap" style="color:#777;">
        MRP <span class="compare-at-price"style="color:red;">{{ matched_mrp | money_without_trailing_zeros }}</span>
      </span>
     

    {%- else -%}
      {%- comment -%} No mapping hit — use override if present, else actual variant pricing {%- endcomment -%}
      {%- if override_active -%}
        {%- assign eff_price = override_price_cents -%}
        {%- assign eff_compare = override_compare_cents -%}
      {%- else -%}
        {%- assign eff_price = variant.price -%}
        {%- assign eff_compare = variant.compare_at_price -%}
      {%- endif -%}

      <sale-price
        {% if form_id %}form="{{ product_form_id }}"{% endif %}
        class="h4 {% if eff_compare and eff_compare > eff_price %}{{ on_sale_price_classes }}{% else %}{{ regular_price_classes }}{% endif %}">
        <span class="sr-only">{{ 'product.price.sale_price' | t }}</span>
        {{ eff_price | money_without_trailing_zeros }}
      </sale-price>

      {%- if eff_compare and eff_compare > eff_price -%}
        <compare-at-price class="{{ compare_at_price_classes }}" id="compare-at-price" style="color:#777;">
          MRP
          <span class="sr-only">{{ 'product.price.regular_price' | t }}</span>
          <span class="c-price">{{ eff_compare | money_without_trailing_zeros }}</span>
        </compare-at-price>
      {%- endif -%}
    {%- endif -%}
  </div>
</div>




{% comment %} NEW CODE FOR PRE LAUNCH AFTERWARDS UNCOMMENT THE ABOVE CODE END {% endcomment %}




<style>
.price-list {
  display: flex;
  gap: 6px;
  align-items: center;
}
.price {
  color: #000;
}
.compare-at-price {
  text-decoration: line-through;
  color: red;
  font-size: 0.9em;
}
</style>

              {%- endif -%}

              {%- if show_rating -%}
                <div class="looxReview smallcaps text-xxs text-subdued">
                  <div
                    class="loox-rating"
                    data-id="{{ product.id }}"
                    data-rating="{{ product.metafields.loox.avg_rating  }}"
                    data-raters="{{ product.metafields.loox.num_reviews }}"
                    data-pattern="([rating])"
                  ></div>
                </div>
                {% comment %}
                  {%- render 'product-rating', product: product, show_empty: settings.show_product_rating_if_empty, display_mode: settings.product_rating_mode -%}
                {% endcomment %}
              {%- endif -%}

              {%- form 'product', product, is: 'product-form' -%}
                <!-- Hidden input for the selected variant -->
                <input
                  type="hidden"
                  name="id"
                  value="{{ product.selected_or_first_available_variant.id }}"
                  id="product-variant-id-{{ product.id }}"
                >

                {%- if product.options contains 'Size' or 'Waist Size' -%}
                  <div class="size-container" style="font-size: 12px; letter-spacing: 3px; display: none;">
                    <div class="size-buttons" data-product-id="{{ product.id }}">
                      {% for variant in product.variants %}
                        {% if variant.available %}
                          <!-- Render only available size buttons -->
                          <button
                            type="button"
                            class="size-btn"
                            data-variant-id="{{ variant.id }}"
                          >
                            {{ variant.option1 }}
                          </button>
                        {% endif %}
                      {% endfor %}
                    </div>
                  </div>
                {%- endif -%}

                <!-- Add to Cart -->
                <button type="submit" class="button button--primary" style="display: none;">
                  ADD TO CART
                </button>
              {%- endform -%}

              <style>
                .size-btn.active { color: #f1bc2a; }
                .button {
                  letter-spacing: 0rem;
                  margin-top: 10px;
                  padding: 6px 11px;
                  font-size: 13px;
                }
              </style>

              <script>
                // Make sure the DOM is loaded
                document.addEventListener("DOMContentLoaded", function() {
                  // Select all size buttons (now only the available ones)
                  const sizeButtons = document.querySelectorAll('.size-btn');

                  sizeButtons.forEach(function(button) {
                    button.addEventListener('click', function(event) {
                      event.preventDefault();

                      // Retrieve the variant ID from the data attribute on the clicked button
                      const selectedVariantId = this.getAttribute('data-variant-id');

                      // Get the hidden input element (assumes there is one per form and product)
                      const productId = this.closest('.size-buttons').getAttribute('data-product-id');
                      const hiddenInput = document.getElementById('product-variant-id-' + productId);

                      // Update the hidden input with the selected variant id
                      hiddenInput.value = selectedVariantId;

                      // Update the UI to reflect the selected size by toggling the active class.
                      sizeButtons.forEach(btn => btn.classList.remove('active'));
                      this.classList.add('active');

                      // Debug
                      console.log("Selected variant id:", selectedVariantId);
                    });
                  });
                });
              </script>
            </div>
          {%- endif -%}
        </div>
      {%- endif -%}

      {%- if show_swatches and settings.product_color_display != 'hide' -%}
        {%- assign color_label_list = 'general.label.color' | t | replace: ', ', ',' | downcase | split: ',' -%}
        {%- for color_label in color_label_list -%}
          {%- if product.options_by_name[color_label] != blank -%}
            {%- assign product_option = product.options_by_name[color_label] -%}
            {%- capture name -%}swatch-{{ section.id }}-{{ product.id }}-{{ product_option.position }}{%- endcapture -%}

            {%- case settings.product_color_display -%}
              {%- when 'count' -%}
                <p class="smallcaps text-subdued">
                  {{- 'product.general.available_colors_count' | t: count: product_option.values.size -}}
                </p>

              {%- when 'swatch' -%}
                <fieldset
                  class="h-stack wrap justify-center gap-1"
                  data-option-position="{{ product_option.position }}"
                >
                  {%- for option_value in product_option.values -%}
                    {%- if forloop.first
                      or product.selected_or_first_available_variant.matched
                      and option_value == product_option.selected_value
                    -%}
                      {%- assign selected = true -%}
                    {%- else -%}
                      {% assign selected = false %}
                    {%- endif -%}

                    {%- render 'swatch' with 'color',
                      value: option_value,
                      name: name,
                      selected: selected,
                      size: 'sm'
                    -%}
                  {%- endfor -%}
                </fieldset>
            {%- endcase -%}

            {%- break -%}
          {%- endif -%}
        {%- endfor -%}
      {%- endif -%}
    </div>

    {%- comment -%}  FOR PRE LAUNCH COLLECTION PAGE START {%- endcomment -%}
    {% comment %} {% if collection and collection.title == "Pre Launch" %}
      <div class="product-card__notify">
        <a
          href="https://wa.me/919251998279?text=Hi,%20I%20would%20like%20to%20sign%20up%20for%20the%20new%20product%20launch%20by%20Saadaa."
          rel="noopener"
          class="notify-btn"
        >
          NOTIFY ME
        </a>
      </div>
    {% endif %} {% endcomment %}
    {%- comment -%}  FOR PRE LAUNCH COLLECTION PAGE END {%- endcomment -%}

  {%- comment -%}
    Close wrapper: </div> for Pre Launch, otherwise </a>
  {%- endcomment -%}
  {% comment %} {% if collection and collection.title == "Pre Launch" %}
    </div>
  {% else %} {% endcomment %}
    </a>
  {% comment %} {% endif %} {% endcomment %}
</product-card>

{% comment %} <style>
  .product-card__notify {
    display: flex;
    justify-content: center;
  }
  .notify-btn {
    background-color: #23b736; /* WhatsApp green */
    color: #fff;
    padding: 5px 37px;
    border-radius: 3px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.3s ease;
    width: fit-content;
    margin-top: 10px;
  }
  .notify-btn:hover { background-color: #1ebe5d; }

   {% if collection and collection.title == "Pre Launch" %}
    .text-subdued  { display: none; }
  {% endif %} 
</style> {% endcomment %}
